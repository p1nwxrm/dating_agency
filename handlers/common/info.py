from aiogram.filters.command import Command
from aiogram import Router, types

from aiogram.fsm.context import FSMContext
from states.admin_states import AdminPanel
from states.moderator_states import ModeratorPanel
from states.user_states import UserMenu

from handlers.users.show_menus.main_menu import show_user_main_menu
from handlers.admins.show_menus.main_menu import show_admin_main_menu
from handlers.moderators.show_menus.main_menu import show_moderator_main_menu

from .start import cmd_start
from database.queries import get_user_role, profile_exists

router = Router()

# ---------------------------
# /info
# ---------------------------
@router.message(Command("info"))
async def show_info(message: types.Message, state: FSMContext):
    user_id = message.from_user.id
    role = get_user_role(user_id)

    # üìú –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
    user_rules = (
        "üìú –ü—Ä–∞–≤–∏–ª–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞–Ω–Ω—è\n\n"
        "–©–æ–± —Å–ø—ñ–ª–∫—É–≤–∞–Ω–Ω—è –∑–∞–ª–∏—à–∞–ª–æ—Å—å –±–µ–∑–ø–µ—á–Ω–∏–º —ñ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–∏–º ‚Äî –¥–æ—Ç—Ä–∏–º—É–π—Å—è —Ü–∏—Ö –ø—Ä–∏–Ω—Ü–∏–ø—ñ–≤ üëá\n\n"
        "1Ô∏è‚É£ –ü–æ–≤–∞–∂–∞–π —ñ–Ω—à–∏—Ö. –ó–∞–±–æ—Ä–æ–Ω–µ–Ω–æ –æ–±—Ä–∞–∂–∞—Ç–∏, –ø—Ä–∏–Ω–∏–∂—É–≤–∞—Ç–∏ —á–∏ –ø—Ä–æ—è–≤–ª—è—Ç–∏ –∞–≥—Ä–µ—Å—ñ—é.\n\n"
        "2Ô∏è‚É£ –ë–µ–∑ —Å–ø–∞–º—É —Ç–∞ —Ä–µ–∫–ª–∞–º–∏. –ù–µ –Ω–∞–¥—Å–∏–ª–∞–π —Å—Ç–æ—Ä–æ–Ω–Ω—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è —á–∏ –ø—Ä–æ–º–æ–º–∞—Ç–µ—Ä—ñ–∞–ª–∏.\n\n"
        "3Ô∏è‚É£ –¢—ñ–ª—å–∫–∏ –ø—Ä–∞–≤–¥–∏–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è. –ù–µ –≤–≤–æ–¥—å —ñ–Ω—à–∏—Ö –≤ –æ–º–∞–Ω—É.\n\n"
        "4Ô∏è‚É£ –ó–∞–±–æ—Ä–æ–Ω–µ–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç. –ù–µ –ø—É–±–ª—ñ–∫—É–π –≤—ñ–¥–≤–µ—Ä—Ç—ñ, —à–æ–∫—É—é—á—ñ –∞–±–æ –Ω–µ–∑–∞–∫–æ–Ω–Ω—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏.\n\n"
        "5Ô∏è‚É£ –ù–µ –≤–∏–¥–∞–≤–∞–π —Å–µ–±–µ –∑–∞ —ñ–Ω—à—É –æ—Å–æ–±—É. –¶–µ —Å–µ—Ä–π–æ–∑–Ω–µ –ø–æ—Ä—É—à–µ–Ω–Ω—è.\n\n"
        "6Ô∏è‚É£ –ë–µ—Ä–µ–∂–∏ —Å–≤–æ—ó –¥–∞–Ω—ñ. –ù–µ –¥—ñ–ª—ñ—Ç—å—Å—è –ø—Ä–∏–≤–∞—Ç–Ω–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –∑ –Ω–µ–∑–Ω–∞–π–æ–º—Ü—è–º–∏.\n\n"
        "üö´ –ó–∞ –ø–æ—Ä—É—à–µ–Ω–Ω—è –ø—Ä–∞–≤–∏–ª –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –º–æ–∂–µ –±—É—Ç–∏ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏–π.\n\n"
        "üí¨ –ß–∞—Ç: @rizzem_chat\n"
        "üõ† –ü—ñ–¥—Ç—Ä–∏–º–∫–∞: @rizzem_support\n"
        "‚öôÔ∏è –ê–¥–º—ñ–Ω: @rizzem_admin"
    )

    # üõ† –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—ñ–≤
    moderator_rules = (
        "üõ† –ü—Ä–∞–≤–∏–ª–∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞\n\n"
        "–Ø–∫ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä, —Ç–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î—à –∫–æ–º–∞–Ω–¥—É –ø—Ä–æ—î–∫—Ç—É. –î–æ—Ç—Ä–∏–º—É–π—Å—è —Ç–∞–∫–∏—Ö –ø—Ä–∏–Ω—Ü–∏–ø—ñ–≤ üëá\n\n"
        "1Ô∏è‚É£ –û–±‚Äô—î–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å. –£—Å—ñ —Ä—ñ—à–µ–Ω–Ω—è –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ —á–µ—Å–Ω–∏–º–∏ –π –Ω–µ—É–ø–µ—Ä–µ–¥–∂–µ–Ω–∏–º–∏.\n\n"
        "2Ô∏è‚É£ –î–æ—Ç—Ä–∏–º—É–π—Å—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ—ó –ø–æ–ª—ñ—Ç–∏–∫–∏ ‚Äî –æ–±—Ä–æ–±–∫–∞ —Å–∫–∞—Ä–≥, –±–∞–Ω—ñ–≤ —Ç–∞ —ñ–Ω—à–∏—Ö –¥—ñ–π.\n\n"
        "3Ô∏è‚É£ –ó–∞–±–æ—Ä–æ–Ω–µ–Ω–æ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –ø–æ–≤–Ω–æ–≤–∞–∂–µ–Ω–Ω—è–º–∏.\n\n"
        "4Ô∏è‚É£ –ö–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ—Å—Ç—å. –ù–µ —Ä–æ–∑–≥–æ–ª–æ—à—É–π –≤–Ω—É—Ç—Ä—ñ—à–Ω—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é.\n\n"
        "5Ô∏è‚É£ –£–≤–∞–∂–Ω—ñ—Å—Ç—å –ø—ñ–¥ —á–∞—Å —Ä–æ–∑–≥–ª—è–¥—É —Å–∫–∞—Ä–≥.\n\n"
        "6Ô∏è‚É£ –í–≤—ñ—á–ª–∏–≤—ñ—Å—Ç—å –ø—Ä–∏ —Ä–æ–±–æ—Ç—ñ –∑ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏.\n"
    )

    # üëë –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∞–¥–º—ñ–Ω—ñ–≤
    admin_rules = (
        "üëë –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä ‚Äî –ø—Ä–∞–≤–∏–ª–∞ —Ä–æ–±–æ—Ç–∏\n\n"
        "1Ô∏è‚É£ –°—Ç—Ä–∞—Ç–µ–≥—ñ—á–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–∏–π–º–∞–π –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ.\n\n"
        "2Ô∏è‚É£ –ü–æ–≤–Ω–∞ –æ–±‚Äô—î–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –ø—Ä–∏ —Ä–æ–±–æ—Ç—ñ –∑—ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ—é, —Å–∫–∞—Ä–≥–∞–º–∏ —Ç–∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞–º–∏.\n\n"
        "3Ô∏è‚É£ –ó–∞–±–æ—Ä–æ–Ω–µ–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∞–¥–º—ñ–Ω-–ø—Ä–∞–≤–∞ —É –≤–ª–∞—Å–Ω–∏—Ö —Ü—ñ–ª—è—Ö.\n\n"
        "4Ô∏è‚É£ –ó–∞–±–µ–∑–ø–µ—á—É–π —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ñ—Å—Ç—å —É—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—ñ–≤.\n\n"
        "5Ô∏è‚É£ –î–æ—Ç—Ä–∏–º—É–π—Å—è –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω–æ—Å—Ç—ñ —Ç–∞ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ñ–≤.\n"
    )

    # –í–∏–±—ñ—Ä –ø—Ä–∞–≤–∏–ª –∑–∞ —Ä–æ–ª–ª—é
    if role == 1:
        # –ê–¥–º—ñ–Ω
        await message.answer(admin_rules)
        await show_admin_main_menu(message.bot, message.chat.id)
        await state.set_state(AdminPanel.main_menu)
        return

    elif role == 2:
        # –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä
        await message.answer(moderator_rules)
        await show_moderator_main_menu(message.bot, message.chat.id)
        await state.set_state(ModeratorPanel.main_menu)
        return

    else:
        # –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á
        await message.answer(user_rules)

        # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ ‚Äî —á–∏ —î –∞–Ω–∫–µ—Ç–∞
        if not profile_exists(user_id):
            # –ù–µ–º–∞—î ‚Üí –ø–æ—á–∏–Ω–∞—î–º–æ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—é
            await cmd_start(message, state)
            return

        # –Ñ ‚Üí –≤—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ –º–µ–Ω—é
        await show_user_main_menu(message.bot, message.chat.id)
        await state.set_state(UserMenu.main_menu)
        return